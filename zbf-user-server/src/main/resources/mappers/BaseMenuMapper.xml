<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zbf.user.mapper.BaseMenuMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="mapVos" type="com.zbf.user.entity.BaseMenu">
        <id column="id" property="id" />
        <result column="version" property="version" />
        <result column="code" property="code" />
        <result column="menuName" property="menuName" />
        <result column="imagePath" property="imagePath" />
        <result column="url" property="url" />
        <result column="parentCode" property="parentCode" />
        <result column="leavl" property="leavl" />
        <result column="createTime" property="createTime" />
        <collection property="menuList" ofType="com.zbf.user.entity.BaseMenu">
            <id column="id2" property="id" />
            <result column="code2" property="code" />
            <result column="imagePath2" property="imagePath" />
            <result column="menuName2" property="menuName" />
            <result column="parentCode2" property="parentCode" />
            <result column="url2" property="url" />
            <collection property="menuList" ofType="com.zbf.user.entity.BaseMenu">
                <id column="id3" property="id" />
                <result column="code3" property="code" />
                <result column="imagePath3" property="imagePath" />
                <result column="menuName3" property="menuName" />
                <result column="parentCode3" property="parentCode" />
                <result column="url3" property="url" />
            </collection>
        </collection>
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, version, code, menuName, imagePath, url, parentCode, leval, createTime
    </sql>


    <select id="getMenuList" resultMap="mapVos">
        SELECT DISTINCT e.id,
 e.CODE,
	e.imagePath,
	e.menuName,
	e.parentCode,
	e.url,
	e2.id id2,
	e2.CODE code2,
	e2.imagePath imagePath2,
	e2.menuName menuName2,
	e2.parentCode parentCode2,
	e2.url url2,
	e3.id id3,
e3.CODE code3,
	e3.imagePath imagePath3,
	e3.menuName menuName3,
	e3.parentCode parentCode3,
	e3.url url3
FROM
	base_user a
	LEFT JOIN base_user_role b ON a.id = b.userId
	LEFT JOIN base_role c ON b.roleId = c.id
	LEFT JOIN base_role_menu d ON c.id = d.role_id
	LEFT JOIN base_menu e ON d.menu_id = e.id
	LEFT JOIN base_menu e2 ON e2.parentCode = e.`code`
	LEFT JOIN base_menu e3 ON e3.parentCode = e2.`code`
WHERE
	a.id= 1
	AND e.parentCode = 0
	AND e.leval = 1
	AND e2.leval = 2
	AND e3.leval = 3
 </select>

</mapper>
